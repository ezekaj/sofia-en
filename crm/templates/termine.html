{% extends "base.html" %}

{% block title %}Ihre Termine - CRM{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="color: #2c3e50;">ğŸ“… Ihre persÃ¶nlichen Termine</h2>
        <a href="/" class="btn">ğŸ”„ Neue Suche</a>
    </div>

    <div class="alert alert-info">
        <strong>ğŸ‘¤ Patient:</strong> {{ patient_name or telefon }}
        {% if telefon and patient_name %}
        <br><strong>ğŸ“ Telefon:</strong> {{ telefon }}
        {% endif %}
        <br><strong>ğŸ“† Zeitraum:</strong>
        {% if zeitraum == 'zukunft' %}ğŸ”® ZukÃ¼nftige Termine
        {% elif zeitraum == 'alle' %}ğŸ“‹ Alle Termine
        {% elif zeitraum == 'vergangen' %}ğŸ“œ Vergangene Termine
        {% endif %}
    </div>

    {% if termine %}
        <div style="margin-bottom: 20px;">
            <strong>ğŸ“Š Gefunden:</strong> {{ termine|length }} Termine
        </div>

        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                        <th style="padding: 15px; text-align: left;">ğŸ“… Datum</th>
                        <th style="padding: 15px; text-align: left;">ğŸ• Uhrzeit</th>
                        <th style="padding: 15px; text-align: left;">ğŸ¦· Behandlung</th>
                        <th style="padding: 15px; text-align: left;">ğŸ“‹ Status</th>
                        <th style="padding: 15px; text-align: left;">ğŸ” Details</th>
                    </tr>
                </thead>
                <tbody>
                    {% for termin in termine %}
                    <tr style="border-bottom: 1px solid #dee2e6;">
                        <td style="padding: 15px;">
                            <strong>{{ termin.datum }}</strong>
                            {% if termin.datum == heute.strftime('%Y-%m-%d') %}
                                <span style="background: #ffc107; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-left: 10px;">HEUTE</span>
                            {% endif %}
                        </td>
                        <td style="padding: 15px;">{{ termin.uhrzeit }}</td>
                        <td style="padding: 15px;">{{ termin.behandlungsart }}</td>
                        <td style="padding: 15px;">
                            {% if termin.status == 'bestÃ¤tigt' %}
                                <span style="background: #28a745; color: white; padding: 4px 12px; border-radius: 4px;">âœ… BestÃ¤tigt</span>
                            {% elif termin.status == 'abgesagt' %}
                                <span style="background: #dc3545; color: white; padding: 4px 12px; border-radius: 4px;">âŒ Abgesagt</span>
                            {% else %}
                                <span style="background: #ffc107; color: white; padding: 4px 12px; border-radius: 4px;">â³ {{ termin.status }}</span>
                            {% endif %}
                        </td>
                        <td style="padding: 15px;">
                            <a href="/termin_details/{{ termin.id }}" class="btn" style="padding: 8px 15px; font-size: 14px;">
                                ğŸ‘ï¸ Ansehen
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

    {% else %}
        <div class="alert alert-warning">
            <h3>ğŸ˜” Keine Termine gefunden</h3>
            <p>FÃ¼r <strong>{{ patient_name or telefon }}</strong> wurden keine Termine gefunden.</p>
            <div style="margin-top: 20px; text-align: center;">
                <a href="/" class="btn">ğŸ”„ Neue Suche starten</a>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="color: #2c3e50;">ğŸ“… Ihre persÃ¶nlichen Termine</h2>
        <a href="/" class="btn">ğŸ”„ Neue Suche</a>
    </div>
    
    <div class="alert alert-info">
        <strong>ğŸ‘¤ Patient:</strong> {{ patient_name or telefon }}
        {% if telefon and patient_name %}
        <br><strong>ğŸ“ Telefon:</strong> {{ telefon }}
        {% endif %}
        <br><strong>ğŸ“† Zeitraum:</strong> 
        {% if zeitraum == 'zukunft' %}ğŸ”® ZukÃ¼nftige Termine
        {% elif zeitraum == 'alle' %}ğŸ“‹ Alle Termine
        {% elif zeitraum == 'vergangen' %}ğŸ“œ Vergangene Termine
        {% endif %}
    </div>
    
    {% if termine %}
        <div style="margin-bottom: 20px;">
            <strong>ğŸ“Š Gefunden:</strong> {{ termine|length }} Termine
        </div>
        
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #dee2e6;">ğŸ“… Datum</th>
                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #dee2e6;">ğŸ• Uhrzeit</th>
                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #dee2e6;">ğŸ¦· Behandlung</th>
                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #dee2e6;">ğŸ“‹ Status</th>
                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #dee2e6;">ğŸ” Details</th>
                    </tr>
                </thead>
                <tbody>
                    {% for termin in termine %}
                    <tr style="border-bottom: 1px solid #dee2e6; {% if termin.datum < heute.strftime('%Y-%m-%d') %}background: #f8f9fa;{% elif termin.datum == heute.strftime('%Y-%m-%d') %}background: #fff3cd;{% endif %}">
                        <td style="padding: 15px;">
                            <strong>{{ termin.datum }}</strong>
                            {% if termin.datum == heute.strftime('%Y-%m-%d') %}
                                <span style="background: #ffc107; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-left: 10px;">HEUTE</span>
                            {% elif termin.datum < heute.strftime('%Y-%m-%d') %}
                                <span style="background: #6c757d; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin-left: 10px;">VERGANGEN</span>
                            {% endif %}
                        </td>
                        <td style="padding: 15px;">{{ termin.uhrzeit }}</td>
                        <td style="padding: 15px;">{{ termin.behandlungsart }}</td>
                        <td style="padding: 15px;">
                            {% if termin.status == 'bestÃ¤tigt' %}
                                <span style="background: #28a745; color: white; padding: 4px 12px; border-radius: 4px;">âœ… BestÃ¤tigt</span>
                            {% elif termin.status == 'abgesagt' %}
                                <span style="background: #dc3545; color: white; padding: 4px 12px; border-radius: 4px;">âŒ Abgesagt</span>
                            {% else %}
                                <span style="background: #ffc107; color: white; padding: 4px 12px; border-radius: 4px;">â³ {{ termin.status }}</span>
                            {% endif %}
                        </td>
                        <td style="padding: 15px;">
                            <a href="/termin_details/{{ termin.id }}" class="btn" style="padding: 8px 15px; font-size: 14px;">
                                ğŸ‘ï¸ Ansehen
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div style="margin-top: 30px; text-align: center;">
            <a href="/?patient_name={{ patient_name }}&telefon={{ telefon }}&zeitraum=zukunft" class="btn">ğŸ”® ZukÃ¼nftige Termine</a>
            <a href="/?patient_name={{ patient_name }}&telefon={{ telefon }}&zeitraum=alle" class="btn">ğŸ“‹ Alle Termine</a>
            <a href="/?patient_name={{ patient_name }}&telefon={{ telefon }}&zeitraum=vergangen" class="btn">ğŸ“œ Vergangene Termine</a>
        </div>
        
    {% else %}
        <div class="alert alert-warning">
            <h3>ğŸ˜” Keine Termine gefunden</h3>
            <p>FÃ¼r <strong>{{ patient_name or telefon }}</strong> wurden keine Termine im gewÃ¤hlten Zeitraum gefunden.</p>
            
            <div style="margin-top: 20px;">
                <strong>ğŸ’¡ MÃ¶gliche GrÃ¼nde:</strong>
                <ul style="margin-top: 10px;">
                    <li>Sie sind unter einem anderen Namen registriert</li>
                    <li>Ihre Telefonnummer ist anders gespeichert</li>
                    <li>Sie haben noch keine Termine vereinbart</li>
                    <li>Der gewÃ¤hlte Zeitraum enthÃ¤lt keine Termine</li>
                </ul>
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <a href="/" class="btn">ğŸ”„ Neue Suche starten</a>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}
